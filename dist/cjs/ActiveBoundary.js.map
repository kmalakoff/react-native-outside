{"version":3,"sources":["ActiveBoundary.ts"],"sourcesContent":["import { useState, Fragment, Children, isValidElement, cloneElement, createElement } from 'react';\nimport type { RefObject, ReactElement, FC, Dispatch, ReactNode } from 'react';\nimport { useEvent } from 'react-native-event';\nimport contains from 'react-native-contains';\nimport { BoundaryProvider, useBoundary, useRef } from 'react-ref-boundary';\n\ninterface ComponentProps {\n  isActive: boolean;\n  setIsActive: Dispatch<boolean>;\n}\n\nfunction Component({ children, isActive, setIsActive }) {\n  const ref = useRef<HTMLElement>(null);\n  const boundary = useBoundary();\n  useEvent(\n    (event) => {\n      if (!isActive) return;\n      for (let i = 0; i < boundary.refs.length; i++) {\n        const x = boundary.refs[i] as RefObject<HTMLElement>;\n        if (x.current && contains(x.current, event.target)) return;\n      }\n      setIsActive(false);\n    },\n    [isActive, setIsActive]\n  );\n\n  return createElement(\n    Fragment,\n    null,\n    Children.map<ReactNode, ReactNode>(children, (child) =>\n      isValidElement(child)\n        ? cloneElement(child as ReactElement<any>, {\n            isActive,\n            setIsActive,\n            ref,\n          })\n        : child\n    )\n  );\n}\n\nexport default function ActiveBoundary({ children }) {\n  const state = useState<boolean>(false);\n  const isActive = state[0];\n  const setIsActive = state[1];\n\n  return createElement(BoundaryProvider, null, createElement<ComponentProps>(Component as FC, { isActive, setIsActive }, children));\n}\n"],"names":["ActiveBoundary","Component","children","isActive","setIsActive","ref","useRef","boundary","useBoundary","useEvent","event","i","refs","length","x","current","contains","target","createElement","Fragment","Children","map","child","isValidElement","cloneElement","state","useState","BoundaryProvider"],"mappings":"AAAA;;;;+BAyCA,SAMC;;;eANuBA,cAAc;;;qBAzCoD,OAAO;gCAExE,oBAAoB;wEACxB,uBAAuB;gCACU,oBAAoB;;;;;;AAO1E,SAASC,SAAS,CAAC,KAAmC,EAAE;QAAnCC,QAAQ,GAAV,KAAmC,CAAjCA,QAAQ,EAAEC,QAAQ,GAApB,KAAmC,CAAvBA,QAAQ,EAAEC,WAAW,GAAjC,KAAmC,CAAbA,WAAW;IAClD,IAAMC,GAAG,GAAGC,IAAAA,iBAAM,OAAA,EAAc,IAAI,CAAC,AAAC;IACtC,IAAMC,QAAQ,GAAGC,IAAAA,iBAAW,YAAA,GAAE,AAAC;IAC/BC,IAAAA,iBAAQ,SAAA,EACN,SAACC,KAAK,EAAK;QACT,IAAI,CAACP,QAAQ,EAAE,OAAO;QACtB,IAAK,IAAIQ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGJ,QAAQ,CAACK,IAAI,CAACC,MAAM,EAAEF,CAAC,EAAE,CAAE;YAC7C,IAAMG,CAAC,GAAGP,QAAQ,CAACK,IAAI,CAACD,CAAC,CAAC,AAA0B,AAAC;YACrD,IAAIG,CAAC,CAACC,OAAO,IAAIC,IAAAA,oBAAQ,QAAA,EAACF,CAAC,CAACC,OAAO,EAAEL,KAAK,CAACO,MAAM,CAAC,EAAE,OAAO;SAC5D;QACDb,WAAW,CAAC,KAAK,CAAC,CAAC;KACpB,EACD;QAACD,QAAQ;QAAEC,WAAW;KAAC,CACxB,CAAC;IAEF,OAAOc,IAAAA,MAAa,cAAA,EAClBC,MAAQ,SAAA,EACR,IAAI,EACJC,MAAQ,SAAA,CAACC,GAAG,CAAuBnB,QAAQ,EAAE,SAACoB,KAAK;eACjDC,IAAAA,MAAc,eAAA,EAACD,KAAK,CAAC,GACjBE,IAAAA,MAAY,aAAA,EAACF,KAAK,EAAuB;YACvCnB,QAAQ,EAARA,QAAQ;YACRC,WAAW,EAAXA,WAAW;YACXC,GAAG,EAAHA,GAAG;SACJ,CAAC,GACFiB,KAAK;KAAA,CACV,CACF,CAAC;CACH;AAEc,SAAStB,cAAc,CAAC,KAAY,EAAE;QAAd,AAAEE,QAAQ,GAAV,KAAY,CAAVA,QAAQ,AAAE;IACjD,IAAMuB,KAAK,GAAGC,IAAAA,MAAQ,SAAA,EAAU,KAAK,CAAC,AAAC;IACvC,IAAMvB,QAAQ,GAAGsB,KAAK,CAAC,CAAC,CAAC,AAAC;IAC1B,IAAMrB,WAAW,GAAGqB,KAAK,CAAC,CAAC,CAAC,AAAC;IAE7B,OAAOP,IAAAA,MAAa,cAAA,EAACS,iBAAgB,iBAAA,EAAE,IAAI,EAAET,IAAAA,MAAa,cAAA,EAAiBjB,SAAS,EAAQ;QAAEE,QAAQ,EAARA,QAAQ;QAAEC,WAAW,EAAXA,WAAW;KAAE,EAAEF,QAAQ,CAAC,CAAC,CAAC;CACnI"}