{"version":3,"sources":["ActiveBoundary.ts"],"sourcesContent":["import { Children, Fragment, cloneElement, createElement, isValidElement, useState } from 'react';\nimport type { Dispatch, FC, ReactElement, ReactNode, RefObject } from 'react';\nimport contains from 'react-native-contains';\nimport { useEvent } from 'react-native-event';\nimport { BoundaryProvider, useBoundary, useRef } from 'react-ref-boundary';\n\nfunction Component({ children, isActive, setIsActive }) {\n  const ref = useRef<HTMLElement>(null);\n  const boundary = useBoundary();\n  useEvent(\n    (event) => {\n      if (!isActive) return;\n      for (let i = 0; i < boundary.refs.length; i++) {\n        const x = boundary.refs[i] as RefObject<HTMLElement>;\n        if (x.current && contains(x.current, event.target)) return;\n      }\n      setIsActive(false);\n    },\n    [isActive, setIsActive]\n  );\n\n  return createElement(\n    Fragment,\n    null,\n    Children.map<ReactNode, ReactNode>(children, (child) =>\n      isValidElement(child)\n        ? // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n          cloneElement(child as ReactElement<any>, {\n            isActive,\n            setIsActive,\n            ref,\n          })\n        : child\n    )\n  );\n}\n\ninterface ComponentProps {\n  isActive: boolean;\n  setIsActive: Dispatch<boolean>;\n}\n\nexport default function ActiveBoundary({ children }) {\n  const state = useState<boolean>(false);\n  const isActive = state[0];\n  const setIsActive = state[1];\n\n  return createElement(BoundaryProvider, null, createElement<ComponentProps>(Component as FC, { isActive, setIsActive }, children));\n}\n"],"names":["ActiveBoundary","Component","children","isActive","setIsActive","ref","useRef","boundary","useBoundary","useEvent","event","i","refs","length","x","current","contains","target","createElement","Fragment","Children","map","child","isValidElement","cloneElement","state","useState","BoundaryProvider"],"mappings":";;;;+BA0CA;;;eAAwBA;;;qBA1CkE;0EAErE;gCACI;gCAC6B;;;;;;AAEtD,SAASC,UAAU,KAAmC;QAAjCC,WAAF,MAAEA,UAAUC,WAAZ,MAAYA,UAAUC,cAAtB,MAAsBA;IACvC,IAAMC,MAAMC,IAAAA,wBAAM,EAAc;IAChC,IAAMC,WAAWC,IAAAA,6BAAW;IAC5BC,IAAAA,0BAAQ,EACN,SAACC;QACC,IAAI,CAACP,UAAU;QACf,IAAK,IAAIQ,IAAI,GAAGA,IAAIJ,SAASK,IAAI,CAACC,MAAM,EAAEF,IAAK;YAC7C,IAAMG,IAAIP,SAASK,IAAI,CAACD,EAAE;YAC1B,IAAIG,EAAEC,OAAO,IAAIC,IAAAA,4BAAQ,EAACF,EAAEC,OAAO,EAAEL,MAAMO,MAAM,GAAG;QACtD;QACAb,YAAY;IACd,GACA;QAACD;QAAUC;KAAY;IAGzB,OAAOc,IAAAA,oBAAa,EAClBC,eAAQ,EACR,MACAC,eAAQ,CAACC,GAAG,CAAuBnB,UAAU,SAACoB;eAC5CC,IAAAA,qBAAc,EAACD,SAEXE,IAAAA,mBAAY,EAACF,OAA4B;YACvCnB,UAAAA;YACAC,aAAAA;YACAC,KAAAA;QACF,KACAiB;;AAGV;AAOe,SAAStB,eAAe,KAAY;QAAZ,AAAEE,WAAF,MAAEA;IACvC,IAAMuB,QAAQC,IAAAA,eAAQ,EAAU;IAChC,IAAMvB,WAAWsB,KAAK,CAAC,EAAE;IACzB,IAAMrB,cAAcqB,KAAK,CAAC,EAAE;IAE5B,OAAOP,IAAAA,oBAAa,EAACS,kCAAgB,EAAE,MAAMT,IAAAA,oBAAa,EAAiBjB,WAAiB;QAAEE,UAAAA;QAAUC,aAAAA;IAAY,GAAGF;AACzH"}