{"version":3,"sources":["ActiveBoundary.ts"],"sourcesContent":["import { Children, Fragment, cloneElement, createElement, isValidElement, useState } from 'react';\nimport type { Dispatch, FC, ReactElement, ReactNode, RefObject } from 'react';\nimport contains from 'react-native-contains';\nimport { useEvent } from 'react-native-event';\nimport { BoundaryProvider, useBoundary, useRef } from 'react-ref-boundary';\n\nfunction Component({ children, isActive, setIsActive }) {\n  const ref = useRef<HTMLElement>(null);\n  const boundary = useBoundary();\n  useEvent(\n    (event) => {\n      if (!isActive) return;\n      for (let i = 0; i < boundary.refs.length; i++) {\n        const x = boundary.refs[i] as RefObject<HTMLElement>;\n        if (x.current && contains(x.current, event.target)) return;\n      }\n      setIsActive(false);\n    },\n    [isActive, setIsActive]\n  );\n\n  return createElement(\n    Fragment,\n    null,\n    Children.map<ReactNode, ReactNode>(children, (child) =>\n      isValidElement(child)\n        ? // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n          cloneElement(child as ReactElement<any>, {\n            isActive,\n            setIsActive,\n            ref,\n          })\n        : child\n    )\n  );\n}\n\ninterface ComponentProps {\n  isActive: boolean;\n  setIsActive: Dispatch<boolean>;\n}\n\nexport default function ActiveBoundary({ children }) {\n  const state = useState<boolean>(false);\n  const isActive = state[0];\n  const setIsActive = state[1];\n\n  return createElement(BoundaryProvider, null, createElement<ComponentProps>(Component as FC, { isActive, setIsActive }, children));\n}\n"],"names":["Children","Fragment","cloneElement","createElement","isValidElement","useState","contains","useEvent","BoundaryProvider","useBoundary","useRef","Component","children","isActive","setIsActive","ref","boundary","event","i","refs","length","x","current","target","map","child","ActiveBoundary","state"],"mappings":"AAAA,SAASA,QAAQ,EAAEC,QAAQ,EAAEC,YAAY,EAAEC,aAAa,EAAEC,cAAc,EAAEC,QAAQ,QAAQ,OAAO,CAAC;AAElG,OAAOC,QAAQ,MAAM,uBAAuB,CAAC;AAC7C,SAASC,QAAQ,QAAQ,oBAAoB,CAAC;AAC9C,SAASC,gBAAgB,EAAEC,WAAW,EAAEC,MAAM,QAAQ,oBAAoB,CAAC;AAE3E,SAASC,SAAS,CAAC,EAAEC,QAAQ,CAAA,EAAEC,QAAQ,CAAA,EAAEC,WAAW,CAAA,EAAE,EAAE;IACtD,MAAMC,GAAG,GAAGL,MAAM,CAAc,IAAI,CAAC,AAAC;IACtC,MAAMM,QAAQ,GAAGP,WAAW,EAAE,AAAC;IAC/BF,QAAQ,CACN,CAACU,KAAK,GAAK;QACT,IAAI,CAACJ,QAAQ,EAAE,OAAO;QACtB,IAAK,IAAIK,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGF,QAAQ,CAACG,IAAI,CAACC,MAAM,EAAEF,CAAC,EAAE,CAAE;YAC7C,MAAMG,CAAC,GAAGL,QAAQ,CAACG,IAAI,CAACD,CAAC,CAAC,AAA0B,AAAC;YACrD,IAAIG,CAAC,CAACC,OAAO,IAAIhB,QAAQ,CAACe,CAAC,CAACC,OAAO,EAAEL,KAAK,CAACM,MAAM,CAAC,EAAE,OAAO;SAC5D;QACDT,WAAW,CAAC,KAAK,CAAC,CAAC;KACpB,EACD;QAACD,QAAQ;QAAEC,WAAW;KAAC,CACxB,CAAC;IAEF,OAAOX,aAAa,CAClBF,QAAQ,EACR,IAAI,EACJD,QAAQ,CAACwB,GAAG,CAAuBZ,QAAQ,EAAE,CAACa,KAAK,GACjDrB,cAAc,CAACqB,KAAK,CAAC,GAEjBvB,YAAY,CAACuB,KAAK,EAAuB;YACvCZ,QAAQ;YACRC,WAAW;YACXC,GAAG;SACJ,CAAC,GACFU,KAAK,CACV,CACF,CAAC;CACH;AAOD,eAAe,SAASC,cAAc,CAAC,EAAEd,QAAQ,CAAA,EAAE,EAAE;IACnD,MAAMe,KAAK,GAAGtB,QAAQ,CAAU,KAAK,CAAC,AAAC;IACvC,MAAMQ,QAAQ,GAAGc,KAAK,CAAC,CAAC,CAAC,AAAC;IAC1B,MAAMb,WAAW,GAAGa,KAAK,CAAC,CAAC,CAAC,AAAC;IAE7B,OAAOxB,aAAa,CAACK,gBAAgB,EAAE,IAAI,EAAEL,aAAa,CAAiBQ,SAAS,EAAQ;QAAEE,QAAQ;QAAEC,WAAW;KAAE,EAAEF,QAAQ,CAAC,CAAC,CAAC;CACnI,CAAA"}