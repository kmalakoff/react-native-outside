{"version":3,"file":"react-native-outside.js","sources":["../../src/ActiveBoundary.ts","../../src/Active.ts"],"sourcesContent":["import { Children, Fragment, cloneElement, createElement, isValidElement, useState } from 'react';\nimport type { Dispatch, FC, ReactElement, ReactNode, RefObject } from 'react';\nimport contains from 'react-native-contains';\nimport { useEvent } from 'react-native-event';\nimport { BoundaryProvider, useBoundary, useRef } from 'react-ref-boundary';\n\nfunction Component({ children, isActive, setIsActive }) {\n  const ref = useRef<HTMLElement>(null);\n  const boundary = useBoundary();\n  useEvent(\n    (event) => {\n      if (!isActive) return;\n      for (let i = 0; i < boundary.refs.length; i++) {\n        const x = boundary.refs[i] as RefObject<HTMLElement>;\n        if (x.current && contains(x.current, event.target)) return;\n      }\n      setIsActive(false);\n    },\n    [isActive, setIsActive]\n  );\n\n  return createElement(\n    Fragment,\n    null,\n    Children.map<ReactNode, ReactNode>(children, (child) =>\n      isValidElement(child)\n        ? // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n          cloneElement(child as ReactElement<any>, {\n            isActive,\n            setIsActive,\n            ref,\n          })\n        : child\n    )\n  );\n}\n\ninterface ComponentProps {\n  isActive: boolean;\n  setIsActive: Dispatch<boolean>;\n}\n\nexport default function ActiveBoundary({ children }) {\n  const state = useState<boolean>(false);\n  const isActive = state[0];\n  const setIsActive = state[1];\n\n  return createElement(BoundaryProvider, null, createElement<ComponentProps>(Component as FC, { isActive, setIsActive }, children));\n}\n","import { Children, Fragment, cloneElement, createElement, isValidElement, useRef, useState } from 'react';\nimport type { ReactElement, ReactNode } from 'react';\nimport contains from 'react-native-contains';\nimport { useEvent } from 'react-native-event';\n\nexport default function Active({ children }) {\n  const state = useState<boolean>(false);\n  const isActive = state[0];\n  const setIsActive = state[1];\n  const ref = useRef<HTMLElement>(null);\n  useEvent(\n    (event) => {\n      if (!isActive) return;\n      if (ref.current && contains(ref.current, event.target)) return;\n      setIsActive(false);\n    },\n    [isActive, setIsActive]\n  );\n\n  return createElement(\n    Fragment,\n    null,\n    Children.map<ReactNode, ReactNode>(children, (child) =>\n      isValidElement(child)\n        ? // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n          cloneElement(child as ReactElement<any>, {\n            isActive,\n            setIsActive,\n            ref,\n          })\n        : child\n    )\n  );\n}\n"],"names":["Component","children","isActive","setIsActive","ref","useRef","boundary","useBoundary","useEvent","event","i","refs","length","x","current","contains","target","createElement","Fragment","Children","map","child","isValidElement","cloneElement","ActiveBoundary","state","useState","BoundaryProvider","Active"],"mappings":"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"}